{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///Users/pratama/Yogawan/Projects/JawirAI/jawiraiv1.6.3/src/pages/api/history/%5Bid%5D.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/router\";\nimport axios from \"axios\";\n\nexport default function ChatDetail() {\n  const router = useRouter();\n  const { id } = router.query;\n  const [chat, setChat] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    if (id) {\n      fetchChatDetail();\n    }\n  }, [id]);\n\n  const fetchChatDetail = async () => {\n    try {\n      const token = localStorage.getItem(\"token\");\n      const response = await axios.get(`http://localhost:3000/api/history/${id}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      setChat(response.data);\n      setMessages(response.data.messages || []);\n    } catch (error) {\n      console.error(\"Error fetching chat detail:\", error.response?.data || error.message);\n    }\n  };\n\n  const handleSend = async () => {\n    if (!input.trim() || input.length > 500) return;\n\n    const userMessage = { role: \"user\", content: input };\n    const newMessages = [...messages, userMessage];\n    setMessages(newMessages);\n    setInput(\"\");\n    setIsLoading(true);\n\n    try {\n      const aiResponse = await requestToGroqAI(input);\n      const aiMessage = { role: \"ai\", content: aiResponse };\n      const updatedMessages = [...newMessages, aiMessage];\n      setMessages(updatedMessages);\n\n      await axios.put(`http://localhost:3000/api/history/${id}`, {\n        messages: updatedMessages,\n      }, {\n        headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n      });\n    } catch {\n      setMessages([...newMessages, { role: \"ai\", content: \"Maaf, terjadi kesalahan.\" }]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div>\n      <h1>{chat?.title || \"Chat Detail\"}</h1>\n      <button onClick={() => router.push(\"/history\")}>Kembali</button>\n      <div className=\"chat-box\">\n        {messages.map((msg, index) => (\n          <p key={index} className={msg.role === \"user\" ? \"user-message\" : \"ai-message\"}>\n            <strong>{msg.role === \"user\" ? \"User\" : \"AI\"}:</strong> {msg.content}\n          </p>\n        ))}\n      </div>\n      <input\n        type=\"text\"\n        value={input}\n        onChange={(e) => setInput(e.target.value)}\n        placeholder=\"Ketik pesan...\"\n      />\n      <button onClick={handleSend} disabled={isLoading}>\n        {isLoading ? \"Mengirim...\" : \"Kirim\"}\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEe,SAAS;IACtB,MAAM,SAAS,CAAA,GAAA,uHAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,EAAE,EAAE,GAAG,OAAO,KAAK;IAC3B,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,mGAAA,CAAA,WAAQ,AAAD,EAAE;IAE3C,CAAA,GAAA,mGAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,IAAI;YACN;QACF;IACF,GAAG;QAAC;KAAG;IAEP,MAAM,kBAAkB;QACtB,IAAI;YACF,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,MAAM,WAAW,MAAM,0GAAA,CAAA,UAAK,CAAC,GAAG,CAAC,CAAC,kCAAkC,EAAE,IAAI,EAAE;gBAC1E,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC;YAC9C;YACA,QAAQ,SAAS,IAAI;YACrB,YAAY,SAAS,IAAI,CAAC,QAAQ,IAAI,EAAE;QAC1C,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,+BAA+B,MAAM,QAAQ,EAAE,QAAQ,MAAM,OAAO;QACpF;IACF;IAEA,MAAM,aAAa;QACjB,IAAI,CAAC,MAAM,IAAI,MAAM,MAAM,MAAM,GAAG,KAAK;QAEzC,MAAM,cAAc;YAAE,MAAM;YAAQ,SAAS;QAAM;QACnD,MAAM,cAAc;eAAI;YAAU;SAAY;QAC9C,YAAY;QACZ,SAAS;QACT,aAAa;QAEb,IAAI;YACF,MAAM,aAAa,MAAM,gBAAgB;YACzC,MAAM,YAAY;gBAAE,MAAM;gBAAM,SAAS;YAAW;YACpD,MAAM,kBAAkB;mBAAI;gBAAa;aAAU;YACnD,YAAY;YAEZ,MAAM,0GAAA,CAAA,UAAK,CAAC,GAAG,CAAC,CAAC,kCAAkC,EAAE,IAAI,EAAE;gBACzD,UAAU;YACZ,GAAG;gBACD,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,aAAa,OAAO,CAAC,UAAU;gBAAC;YACtE;QACF,EAAE,OAAM;YACN,YAAY;mBAAI;gBAAa;oBAAE,MAAM;oBAAM,SAAS;gBAA2B;aAAE;QACnF,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,qKAAC;;0BACC,qKAAC;0BAAI,MAAM,SAAS;;;;;;0BACpB,qKAAC;gBAAO,SAAS,IAAM,OAAO,IAAI,CAAC;0BAAa;;;;;;0BAChD,qKAAC;gBAAI,WAAU;0BACZ,SAAS,GAAG,CAAC,CAAC,KAAK,sBAClB,qKAAC;wBAAc,WAAW,IAAI,IAAI,KAAK,SAAS,iBAAiB;;0CAC/D,qKAAC;;oCAAQ,IAAI,IAAI,KAAK,SAAS,SAAS;oCAAK;;;;;;;4BAAU;4BAAE,IAAI,OAAO;;uBAD9D;;;;;;;;;;0BAKZ,qKAAC;gBACC,MAAK;gBACL,OAAO;gBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gBACxC,aAAY;;;;;;0BAEd,qKAAC;gBAAO,SAAS;gBAAY,UAAU;0BACpC,YAAY,gBAAgB;;;;;;;;;;;;AAIrC"}},
    {"offset": {"line": 246, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}